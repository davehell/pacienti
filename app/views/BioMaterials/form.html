#{extends 'main.html' /}

#{ifnot bioMaterial?.id}
    #{set title:'Nový materiál' /}
#{/ifnot}
#{else}
    #{set title:'Materiál ' + bioMaterial.typ /}
#{/else}

#{ifErrors}
    <p class="error">
        Opravte chyby ve formuláři!
    </p>
#{/ifErrors}

<form>
<fieldset>
  <legend>Pacient</legend>
  <ul>
   <li>#{a @Patients.detail(pacient?.id)}${pacient?.getKod()}#{/a}</li>
   <li>${pacient?.jmeno} </li>
   <li>${pacient?.rodneCislo} </li>
  </ul>
</fieldset>
</form>


#{form @mySave(bioMaterial?.id)}
<fieldset>
  <legend>Zadejte informace o biologickém materiálu</legend>

#{field 'bioMaterial.typ'}
<p>
  <label>&{field.name} </label><br>
  <span class="small">${typyMaterialu?.join(', ') }</span><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.typ}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}

#{field 'bioMaterial.datumOdberu'}
<p>
  <label>&{field.name} </label><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.datumOdberu?.format('dd.MM.yyyy')}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}

#{field 'bioMaterial.casOdberu'}
<p>
  <label>&{field.name} </label><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.casOdberu?.format('hh:mm')}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}

#{field 'bioMaterial.datumPrijeti'}
<p>
  <label>&{field.name} </label><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.datumPrijeti?.format()}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}

#{field 'bioMaterial.casPrijeti'}
<p>
  <label>&{field.name} </label><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.casPrijeti?.format('hh:mm')}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}

#{field 'bioMaterial.parafaPrijeti.id'}
<p>
  <label>&{field.name} </label><br>
  #{select "${field.name}", value:"${bioMaterial?.parafaPrijeti?.id}", id:"${field.name}"}
  	#{option }vyberte#{/option}
    #{list users}
      #{option "${_.id}"}${_.parafa}#{/option}
    #{/list}
  #{/select}
  <span class="error">#{error 'bioMaterial.parafaPrijeti' /} </span>
</p>
#{/}

#{field 'bioMaterial.datumIzolace'}
<p>
  <label>&{field.name} </label><br>
  <input type="text" id="${field.id}" name="${field.name}" value="${bioMaterial?.datumIzolace?.format('dd.MM.yyyy')}" class="${field.errorClass}">
  <span class="error">${field.error} </span>
</p>
#{/}


#{field 'bioMaterial.parafaIzolace.id'}
<p>
  <label>&{field.name} </label><br>
  #{select "${field.name}", value:"${bioMaterial?.parafaIzolace?.id}", id:"${field.name}"}
  	#{option }vyberte#{/option}
    #{list users}
      #{option "${_.id}"}${_.parafa}#{/option}
    #{/list}
  #{/select}
  <span class="error">#{error 'bioMaterial.parafaIzolace' /} </span>
</p>
#{/}

<input type="hidden" name="pacientId" value="${pacient?.id}">
<input type="hidden" name="bioMaterial.id" value="${bioMaterial?.id}">


    <p>
        <input type="submit" value="Uložit" />
    </p>
</fieldset>
#{/form}


<script type="text/javascript">
    var calSetup = {
			showOn: "button",
      buttonImage: "@{'/public/images/calendar.gif'}",
			buttonImageOnly: true,
      dateFormat: "dd.mm.yy"
		};

		$( "#bioMaterial_datumOdberu" ).datepicker(calSetup);
		$( "#bioMaterial_datumPrijeti" ).datepicker(calSetup);
		$( "#bioMaterial_datumIzolace" ).datepicker(calSetup);

		var typyMaterialu = [
      #{list typyMaterialu}
        "${_.raw()}" ${_isLast ? '' : ','}
      #{/list}
    ];

		$( "#bioMaterial_typ" ).autocomplete({
			source: typyMaterialu
		});


</script>