<!DOCTYPE html>

<html>
  <head>
    <title>Neprovedená vyšetření</title>
    <meta charset="${_response_encoding}">
    <style media="print">
     body {font-family: "Times New Roman", sans-serif; font-size: 10pt;}
     .totalSum {border-top: 1px solid black;}
     .totalSum, .sum {text-align: right; padding-right: 1em;}
     table {width: 100%;}
    </style>
  </head>
  <body>

<h1>Neprovedená vyšetření</h1>
<p>
 Období: ${datumOd.format()} - ${datumDo.format()}
</p>

#{if vysetreni}
  <table>
    <thead>
      <th>Vyšetření</th>
      <th>Ev. číslo</th>
      <th>Jméno</th>
      <th>Konc. DNA</th>
      <th>Body</th>
    </thead>
    <tbody>

%{
  vysId = 0;
  vysSum = 0;
  sum = 0;
  i = 0;
}%

    #{list vysetreni}
%{
  i++;
  vysSum += _.vysetreni.body;
  if(i > 1 && _.vysetreni.id != vysId ) {
}%
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td class="sum">${sum.format("###,###")}</td>
    </tr>
%{
    sum = 0;
 }
 sum += _.vysetreni.body;
}%
    <tr>
      <td>#{if _.vysetreni.id != vysId}${_.vysetreni.nazev}#{/if} </td>
      <td>${_.pacient.getKod()} </td>
      <td>${_.pacient.toString()} </td>
      <td>${_.pacient.getKonc().raw()} </td>
      <td>&nbsp;</td>
    </tr>

#{if _isLast}
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td class="sum">${sum.format("###,###")}</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td>&nbsp;</td>
      <td class="totalSum">${vysSum.format("###,###")} </td>
    </tr>
#{/if}
%{
vysId = (int)_.vysetreni.id;
}%

    #{/list}

    </tbody>
  </table>

<p>
 ${modul.formNeprovVys}
</p>
#{/if}
#{else}
    <div class="empty">
        &{'noRecords'}
    </div>
#{/else}

  </body>
</html>